---
alwaysApply: false
---

# Regla: Debug Assist - Asistencia Proactiva en Debugging

**Descripci√≥n:** Gu√≠a para buscar proactivamente soluciones validadas cuando el usuario reporta errores, fallos de tests, o problemas de c√≥digo.

## Cu√°ndo Activar Esta Regla

Esta regla se activa cuando:
- El usuario pega un mensaje de error o stacktrace
- El usuario reporta que un test est√° fallando
- El usuario menciona un problema o bug
- El usuario pregunta "¬øpor qu√© falla...?" o "¬øc√≥mo arreglar...?"

## Workflow de Debugging Proactivo

### 1. An√°lisis Inicial del Error

Cuando se detecta un error o problema:
- Extraer el tipo de error (TypeError, ValueError, etc.)
- Extraer el mensaje de error clave
- Identificar archivos o m√≥dulos mencionados
- Identificar funciones o l√≠neas de c√≥digo relevantes

### 2. B√∫squeda Proactiva en M√∫ltiples Colecciones

**Paso 1: Buscar en Derived Learnings (Prioridad Alta)**
```python
# Buscar soluciones validadas primero
mcp_chroma_query_documents(
    collection_name="derived_learnings_v1",
    query_texts=[f"error {error_type} {error_message_keywords}"],
    n_results=3
)
```

**Paso 2: Buscar en Chat History (Contexto de Soluciones)**
```python
# Buscar discusiones previas sobre este error
mcp_chroma_query_documents(
    collection_name="chat_history_v1",
    query_texts=[f"error {error_type} {error_message_keywords} fix solution"],
    n_results=5
)
```

**Paso 3: Buscar en Test Results (Transiciones de Tests)**
```python
# Buscar tests que fallaron y fueron corregidos
mcp_chroma_query_documents(
    collection_name="test_results_v1",
    query_texts=[f"test failure {error_message_keywords}"],
    n_results=5
)
```

**Paso 4: Buscar en Validation Evidence (Evidencia de Fixes)**
```python
# Buscar evidencia de validaci√≥n de fixes similares
mcp_chroma_query_documents(
    collection_name="validation_evidence_v1",
    query_texts=[f"error resolution {error_type}"],
    n_results=3
)
```

**Paso 5: Buscar en Codebase (C√≥digo Relacionado)**
```python
# Buscar c√≥digo relacionado con el error
mcp_chroma_query_documents(
    collection_name="codebase_v1",
    query_texts=[f"{file_path} {function_name} {error_type}"],
    n_results=5
)
```

### 3. Priorizaci√≥n de Resultados

Priorizar resultados en este orden:
1. **Derived Learnings** con `validation_evidence_id` (soluciones validadas)
2. **Chat History** con alta `confidence_score` (>0.8) y evidencia de validaci√≥n
3. **Test Results** con transiciones de fallido a pasado
4. **Validation Evidence** con alta puntuaci√≥n
5. **Codebase** con c√≥digo relacionado

### 4. Presentaci√≥n de Soluciones

Al presentar soluciones encontradas:
- **Mencionar expl√≠citamente** si la soluci√≥n est√° validada (derived learning o validation evidence)
- **Incluir contexto** de c√≥mo se resolvi√≥ anteriormente (chat history, test transitions)
- **Mostrar c√≥digo** de ejemplo si est√° disponible
- **Priorizar soluciones** con evidencia de validaci√≥n sobre soluciones te√≥ricas

### 5. Sugerencia de Validaci√≥n

Si se encuentra una soluci√≥n pero no tiene evidencia de validaci√≥n:
- Sugerir crear un test para validar la soluci√≥n
- Sugerir registrar la evidencia de validaci√≥n despu√©s de verificar el fix
- Sugerir promover a derived learnings si la soluci√≥n es exitosa

## Ejemplo de Uso

### Escenario: Error de Test
```
Usuario: "El test UserServiceTest::testCreateUser est√° fallando con 'TypeError: Cannot read property value of undefined'"
```

**Acci√≥n del AI:**
1. Buscar en `derived_learnings_v1`: "TypeError undefined property null safety"
2. Buscar en `chat_history_v1`: "testCreateUser TypeError fix"
3. Buscar en `test_results_v1`: "testCreateUser failure"
4. Buscar en `validation_evidence_v1`: "TypeError resolution"
5. Buscar en `codebase_v1`: "UserService createUser"

**Respuesta:**
```
üîç Contexto de Memoria: Encontr√© una soluci√≥n validada para este tipo de error.

En `derived_learnings_v1` hay un patr√≥n validado: "Siempre verificar null/undefined antes de acceder a propiedades de objetos". Esta soluci√≥n fue validada mediante una transici√≥n de test (test fallido ‚Üí test pasado) con un validation_score de 0.9.

Adem√°s, en `chat_history_v1` encontr√© una discusi√≥n previa donde se resolvi√≥ un error similar en UserService hace 2 semanas. El fix involucr√≥ a√±adir verificaciones null antes de acceder a propiedades.

Soluci√≥n recomendada (validada):
- A√±adir verificaciones null/undefined antes de acceder a propiedades
- Usar optional chaining (?.) o verificaciones expl√≠citas
- Ver c√≥digo de ejemplo en: src/UserService.php:42-45
```

## Integraci√≥n con Enhanced Context Capture

Cuando se resuelve un error:
- Registrar en `chat_history_v1` con metadata de error resuelto
- Vincular con `validation_evidence_v1` si hay evidencia de validaci√≥n
- Promover a `derived_learnings_v1` si la soluci√≥n es exitosa y reutilizable

## Mejores Pr√°cticas

1. **Siempre buscar primero en Derived Learnings** - Priorizar soluciones validadas
2. **Incluir contexto de validaci√≥n** - Mencionar si la soluci√≥n tiene evidencia de validaci√≥n
3. **Buscar en m√∫ltiples colecciones** - No limitarse a una sola fuente
4. **Priorizar por evidencia** - Soluciones con validation_evidence_id tienen mayor prioridad
5. **Sugerir validaci√≥n** - Si no hay evidencia, sugerir crear tests o registrar evidencia
